<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic&display=swap" rel="stylesheet">

    <title>iPad Air4 주문</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <style>

        body {
            font-family: 'Nanum Gothic', sans-serif;
            background-color: rgba(204, 204, 204, 0.06);
        }

        .container {
            width: 700px;
            height: auto;
        }

        /*PRODUCT*/

        .exchangeRate {
            color: blue;
        }

        .product {
        }

        .product img {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;

            width: auto;
            padding: 30px 100px;
        }

        .product h2 {
            display: inline;
            width: 400px;
            font-weight: bold;
            padding-top: 30px;
        }

        .product h4 {
            display: inline;
            width: 300px;
            font-size: 20px;
        }

        .product p {
            padding-top: 10px;
        }

        /*ORDER*/

        .order h3 {
            font-weight: 500;
            padding: 10px 0;
        }

        /*BUTTON*/

        .button {
            width: auto;
            display: flex;
            justify-content: center;
        }

        /*TABLE*/

        .orderInfo {
            margin: 20px 0;
            display: flex;
            text-align: center;
        }

        thead {
            background-color: aliceblue;

        }

    </style>

    <script>
        $(document).ready(function () {
            $("#orderInfoList").html("");
            showOrders();

            $.ajax({
                type: "GET",
                url: "https://api.manana.kr/exchange/rate.json",
                data: {},
                success: function (response) {
                    let nowRate = response[1]['rate'];
                    $('#exchangeDollar').text(nowRate);
                }
            })

        });

        function postOrder() {

            let name = $('#orderName').val();
            let color = $('#orderColor').val();
            let count = $('#orderCount').val();
            let address = $('#orderAddress').val();
            let tel = $('#orderTel').val();

            console.log(name, color, count, address, tel);

            if (name === '') {
                alert('주문자 이름을 적어주세요');
                $('#orderName').focus();
                return;

            } else if (color === '') {
                alert('색상을 선택해주세요');
                $('#orderColor').focus();
                return;

            } else if (count === '') {
                alert('수량을 입력해주세요');
                $('#orderCount').focus();
                return;

            } else if (address === '') {
                alert('주소를 입력해주세요')
                $('#orderAddress').focus();
                return;

            } else if (tel === '') {
                alert('전화번호를 입력해주세요')
                $('#orderTel').focus();
                return;

            } else if (!tel.match(/^[0-9]{3}-[0-9]{4}-[0-9]{4}/)) {
                alert('입력 형식이 틀립니다. \n전화번호는 010-XXXX-XXXX 형태로 입력해주세요.')
                $('#orderTel').focus();
                return;

            } //else {
            //     alert('주문이 완료되었습니다 :)')
            // }

            $.ajax({
                type: "POST",
                url: "/order",
                data: {
                    'name_give': name,
                    'color_give': color,
                    'count_give': count,
                    'address_give': address,
                    'tel_give': tel
                },
                success: function (response) {
                    if (response['result'] === 'success') {
                        alert(response['msg']);
                        location.reload();
                    }
                }
            })

        }

        function showOrders() {

            $.ajax({
                type: 'GET',
                url: '/order',
                data: {},
                success: function (response) {
                    if (response['result'] === 'success') {
                        let data = response['order'];
                        for (let i = 0; i < data.length; i++) {
                            let orders = data[i];

                            let name = orders['name'];
                            let color = orders['color'];
                            let count = orders['count'];
                            let address = orders['address'];
                            let tel = orders['tel'];

                            newOrderRow(name, color, count, address, tel);
                        }

                    }
                }
            })

        }

        function newOrderRow(name, color, count, address, tel) {
            let tempHtml = `<tr>
                                <td>${name}</td>
                                <td>${color}</td>
                                <td>${count}</td>
                                <td>${address}</td>
                                <td>${tel}</td>
                            </tr>`;

            $('#orderInfoList').append(tempHtml);
        }


    </script>

</head>
<body>

<div class="container">

    <div class="product">

        <div class="iPadImage">

            <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                <ol class="carousel-indicators">
                    <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                    <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                    <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                    <li data-target="#carouselExampleIndicators" data-slide-to="3"></li>
                    <li data-target="#carouselExampleIndicators" data-slide-to="4"></li>
                </ol>
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img class="d-block w-100"
                             src="https://store.storeimages.cdn-apple.com/8756/as-images.apple.com/is/ipad-air-select-wifi-spacegray-202009?wid=470&hei=556&fmt=png-alpha&.v=1598650646000"
                             alt="Space Gray">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100"
                             src="https://store.storeimages.cdn-apple.com/8756/as-images.apple.com/is/ipad-air-select-wifi-silver-202009?wid=470&hei=556&fmt=png-alpha&.v=1598650645000"
                             alt="Silver">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100"
                             src="https://store.storeimages.cdn-apple.com/8756/as-images.apple.com/is/ipad-air-select-wifi-gold-202009?wid=470&hei=556&fmt=png-alpha&.v=1598650644000"
                             alt="Rose Gold">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100"
                             src="https://store.storeimages.cdn-apple.com/8756/as-images.apple.com/is/ipad-air-select-wifi-green-202009?wid=470&hei=556&fmt=png-alpha&.v=1598650644000"
                             alt="Green">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100"
                             src="https://store.storeimages.cdn-apple.com/8756/as-images.apple.com/is/ipad-air-select-wifi-blue-202009?wid=470&hei=556&fmt=png-alpha&.v=1598650644000"
                             alt="Sky Blue">
                    </div>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>

        </div>

        <h2>Apple iPad Air 4</h2>
        <h4>가격: 949,000 /개</h4>
        <p>Powerful. Colorful. Wonderful. <br>
            iPad와 함께라면 컴퓨터에 기대할 만한 모든 성능은 물론, 어느 컴퓨터에도 기대하지 못했던 놀라운 기능까지 모두 만날 수 있습니다. </p>
    </div>
    <div class="order">
        <h3>주문하기</h3>
        <p class="exchangeRate">
            달러-원 환율 :
            <span id="exchangeDollar"></span>
        </p>
        <div class="input-group mb-3">
            <div class="input-group-prepend">
                <span class="input-group-text" id="inputGroup-sizing-default">주문자 이름</span>
            </div>
            <input type="text" class="form-control" aria-label="Default" aria-describedby="inputGroup-sizing-default"
                   id="orderName">
        </div>

        <div class="input-group mb-3">
            <div class="input-group-prepend">
                <label class="input-group-text" for="orderColor">색상 선택</label>
            </div>
            <select class="custom-select" id="orderColor">
                <option selected value="">------------------</option>
                <option value="스페이스그레이">스페이스 그레이</option>
                <option value="실버">실버</option>
                <option value="로즈골드">로즈골드</option>
                <option value="그린">그린</option>
                <option value="스카이블루">스카이블루</option>
            </select>
        </div>

        <div class="input-group mb-3">
            <div class="input-group-prepend">
                <span class="input-group-text">주문수량</span>
            </div>
            <input type="number" min="0" class="form-control" aria-label="Default"
                   aria-describedby="inputGroup-sizing-default" id="orderCount">
        </div>

        <div class="input-group mb-3">
            <div class="input-group-prepend">
                <span class="input-group-text">주소</span>
            </div>
            <input type="text" class="form-control" aria-label="Default" aria-describedby="inputGroup-sizing-default"
                   id="orderAddress">
        </div>

        <div class="input-group mb-3">
            <div class="input-group-prepend">
                <span class="input-group-text">전화번호</span>
            </div>
            <input type="text" class="form-control" aria-label="Default" aria-describedby="inputGroup-sizing-default"
                   id="orderTel">
        </div>

    </div>

    <div class="button">
        <button class="btn btn-primary" onclick="postOrder()" type="submit">주문하기</button>
    </div>

    <div class="orderInfo">
        <table border=".5" width="680">
            <thead>
            <tr>
                <td>이름</td>
                <td>색상</td>
                <td>개수</td>
                <td>주소</td>
                <td>전화번호</td>
            </tr>
            </thead>
            <tbody id="orderInfoList">

            </tbody>
        </table>
    </div>

</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>

</body>
</html>